/*! This file is auto-generated */
!function(){"use strict";var r={d:function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},e={},t=(r.r(e),r.d(e,{store:function(){return U}}),{}),n=(r.r(t),r.d(t,{__experimentalGetAllAnnotationsForBlock:function(){return T},__experimentalGetAnnotations:function(){return N},__experimentalGetAnnotationsForBlock:function(){return x},__experimentalGetAnnotationsForRichText:function(){return b}}),{}),o=(r.r(n),r.d(n,{__experimentalAddAnnotation:function(){return D},__experimentalRemoveAnnotation:function(){return S},__experimentalRemoveAnnotationsBySource:function(){return F},__experimentalUpdateAnnotationRange:function(){return P}}),window.gc.richText),a=window.gc.i18n;const i="core/annotations",l="core/annotation",c="annotation-text-";const{name:u,...s}={name:l,title:(0,a.__)("\u6279\u6ce8"),tagName:"mark",className:"annotation-text",attributes:{className:"class",id:"id"},edit(){return null},__experimentalGetPropsForEditableTreePreparation(e,{richTextIdentifier:t,blockClientId:n}){return{annotations:e(i).__experimentalGetAnnotationsForRichText(n,t)}},__experimentalCreatePrepareEditableTree({annotations:n}){return(e,t)=>{var a;return 0===n.length?e:([a,e=[]]=[{formats:e,text:t},n],e.forEach(e=>{let{start:t,end:n}=e;t>a.text.length&&(t=a.text.length),n>a.text.length&&(n=a.text.length);var r=c+e.source,e=c+e.id;a=(0,o.applyFormat)(a,{type:l,attributes:{className:r,id:e}},t,n)}),a.formats)}},__experimentalGetPropsForEditableTreeChangeHandler(e){return{removeAnnotation:e(i).__experimentalRemoveAnnotation,updateAnnotationRange:e(i).__experimentalUpdateAnnotationRange}},__experimentalCreateOnChangeEditableValue(u){return e=>{var a,o,i,e=function(e){const r={};return e.forEach((e,n)=>{(e=(e=e||[]).filter(e=>e.type===l)).forEach(e=>{let t=e.attributes["id"];t=t.replace(c,""),r.hasOwnProperty(t)||(r[t]={start:n}),r[t].end=n+1})}),r}(e),{removeAnnotation:t,updateAnnotationRange:n,annotations:r}=u;[r,a,{removeAnnotation:o,updateAnnotationRange:i}]=[r,e,{removeAnnotation:t,updateAnnotationRange:n}],r.forEach(e=>{var t,n,r=a[e.id];r?({start:t,end:n}=e,t===r.start&&n===r.end||i(e.id,r.start,r.end)):o(e.id)})}}};(0,o.registerFormatType)(u,s);var a=window.gc.hooks,d=window.gc.data;function p(e,t){t=e.filter(t);return e.length===t.length?e:t}(0,a.addFilter)("editor.BlockListBlock","core/annotations",e=>(0,d.withSelect)((e,{clientId:t,className:n})=>{return{className:e(i).__experimentalGetAnnotationsForBlock(t).map(e=>"is-annotated-by-"+e.source).concat(n).filter(Boolean).join(" ")}})(e));const f=(e,r)=>Object.entries(e).reduce((e,[t,n])=>({...e,[t]:r(n)}),{});function g(e={},r){var t;switch(r.type){case"ANNOTATION_ADD":var n,a=r.blockClientId,o={id:r.id,blockClientId:a,richTextIdentifier:r.richTextIdentifier,source:r.source,selector:r.selector,range:r.range};return"range"!==o.selector||"number"==typeof(t=o.range).start&&"number"==typeof t.end&&t.start<=t.end?(n=null!=(t=e?.[a])?t:[],{...e,[a]:[...n,o]}):e;case"ANNOTATION_REMOVE":return f(e,e=>p(e,e=>e.id!==r.annotationId));case"ANNOTATION_UPDATE_RANGE":return f(e,e=>{let t=!1;var n=e.map(e=>e.id===r.annotationId?(t=!0,{...e,range:{start:r.start,end:r.end}}):e);return t?n:e});case"ANNOTATION_REMOVE_SOURCE":return f(e,e=>p(e,e=>e.source!==r.source))}return e}var m,h={};function _(e){return[e]}function A(e,t,n){var r;if(e.length===t.length){for(r=n;r<e.length;r++)if(e[r]!==t[r])return;return 1}}function v(i,e){var l,u=e||_;function t(){l=new WeakMap}function n(){for(var e,t,n,r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];for((e=function(e){for(var t,n,r,a,o=l,i=!0,u=0;u<e.length;u++){if(t=e[u],!(r=t)||"object"!=typeof r){i=!1;break}o=o.has(t)?o.get(t):(r=new WeakMap,o.set(t,r),r)}return o.has(h)||((n=a={clear:function(){a.head=null}}).isUniqueByDependants=i,o.set(h,n)),o.get(h)}(n=u.apply(null,a))).isUniqueByDependants||(e.lastDependants&&!A(n,e.lastDependants,0)&&e.clear(),e.lastDependants=n),t=e.head;t;){if(A(t.args,a,1))return t!==e.head&&(t.prev.next=t.next,t.next&&(t.next.prev=t.prev),t.next=e.head,t.prev=null,e.head.prev=t,e.head=t),t.val;t=t.next}return t={val:i.apply(null,a)},a[0]=null,t.args=a,e.head&&((e.head.prev=t).next=e.head),(e.head=t).val}return n.getDependants=u,(n.clear=t)(),n}const y=[],x=v((e,t)=>{return(null!=(e=e?.[t])?e:[]).filter(e=>"block"===e.selector)},(e,t)=>{return[null!=(e=e?.[t])?e:y]});function T(e,t){return null!=(e=e?.[t])?e:y}const b=v((e,t,n)=>{return(null!=(e=e?.[t])?e:[]).filter(e=>"range"===e.selector&&n===e.richTextIdentifier).map(e=>{const{range:t,...n}=e;return{...t,...n}})},(e,t)=>{return[null!=(e=e?.[t])?e:y]});function N(e){return Object.values(e).flat()}var O=new Uint8Array(16);var I=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var R=function(e){return"string"==typeof e&&I.test(e)},w=[],E=0;E<256;++E)w.push((E+256).toString(16).substr(1));var k=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=(w[e[t+0]]+w[e[t+1]]+w[e[t+2]]+w[e[t+3]]+"-"+w[e[t+4]]+w[e[t+5]]+"-"+w[e[t+6]]+w[e[t+7]]+"-"+w[e[t+8]]+w[e[t+9]]+"-"+w[e[t+10]]+w[e[t+11]]+w[e[t+12]]+w[e[t+13]]+w[e[t+14]]+w[e[t+15]]).toLowerCase();if(R(e))return e;throw TypeError("Stringified UUID is invalid")};var C=function(e,t,n){var r=(e=e||{}).random||(e.rng||function(){if(m=m||"undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto))return m(O);throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")})();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return k(r)};function D({blockClientId:e,richTextIdentifier:t=null,range:n=null,selector:r="range",source:a="default",id:o=C()}){o={type:"ANNOTATION_ADD",id:o,blockClientId:e,richTextIdentifier:t,source:a,selector:r};return"range"===r&&(o.range=n),o}function S(e){return{type:"ANNOTATION_REMOVE",annotationId:e}}function P(e,t,n){return{type:"ANNOTATION_UPDATE_RANGE",annotationId:e,start:t,end:n}}function F(e){return{type:"ANNOTATION_REMOVE_SOURCE",source:e}}const U=(0,d.createReduxStore)(i,{reducer:g,selectors:t,actions:n});(0,d.register)(U),(window.gc=window.gc||{}).annotations=e}();