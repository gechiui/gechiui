/*! This file is auto-generated */
!function(s){var n=s("#appkeys-section"),t=n.find(".create-appkey"),i=t.find("#new_appname"),o=t.find("#do_new_appkey"),r=n.find(".appkeys-list-table-wrapper"),p=n.find("tbody"),d=p.find(".no-items"),e=s("#revoke-all-appkeys"),c=gc.template("new-appkey"),l=gc.template("appkey-row"),u=s("#user_id").val();function f(e,a,n){g(n=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:n,"error")}function g(e,a){a=s("<div></div>").attr("role","alert").attr("tabindex","-1").addClass("is-dismissible notice notice-"+a).append(s("<p></p>").text(e)).append(s("<button></button>").attr("type","button").addClass("notice-dismiss").append(s("<span></span>").addClass("screen-reader-text").text(gc.i18n.__("\u5ffd\u7565\u6b64\u901a\u77e5\u3002"))));return t.after(a),a}function v(){s(".notice",n).remove()}o.on("click",function(e){var a;e.preventDefault(),o.prop("aria-disabled")||(0===(e=i.val()).length?i.trigger("focus"):(v(),o.prop("aria-disabled",!0).addClass("disabled"),a={name:e},a=gc.hooks.applyFilters("gc_appkeys_new_password_request",a,u),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys?_locale=user",method:"POST",data:a}).always(function(){o.removeProp("aria-disabled").removeClass("disabled")}).done(function(e){i.val(""),o.prop("disabled",!1),t.after(c({name:e.name,password:e.password})),s(".new-appkey-notice").trigger("focus"),p.prepend(l(e)),r.show(),d.remove(),gc.hooks.doAction("gc_appkeys_created_password",e,a)}).fail(f)))}),p.on("click",".delete",function(e){var a,n;e.preventDefault(),window.confirm(gc.i18n.__("\u662f\u5426\u786e\u5b9a\u5e9f\u9664\u6b64\u5bc6\u7801\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u6d88\u3002"))&&(a=s(this),e=(n=a.closest("tr")).data("uuid"),v(),a.prop("disabled",!0),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys/"+e+"?_locale=user",method:"DELETE"}).always(function(){a.prop("disabled",!1)}).done(function(e){e.deleted&&(0===n.siblings().length&&r.hide(),n.remove(),g(gc.i18n.__("\u5e94\u7528\u7a0b\u5e8f\u5bc6\u7801\u5df2\u5e9f\u9664\u3002"),"success").trigger("focus"))}).fail(f))}),e.on("click",function(e){var a;e.preventDefault(),window.confirm(gc.i18n.__("\u60a8\u786e\u5b9a\u8981\u64a4\u9500\u6240\u6709\u5bc6\u7801\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u6d88\u3002"))&&(a=s(this),v(),a.prop("disabled",!0),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys?_locale=user",method:"DELETE"}).always(function(){a.prop("disabled",!1)}).done(function(e){e.deleted&&(p.children().remove(),n.children(".new-appkey").remove(),r.hide(),g(gc.i18n.__("\u5df2\u64a4\u9500\u6240\u6709\u5e94\u7528\u7a0b\u5e8f\u5bc6\u7801\u3002"),"success").trigger("focus"))}).fail(f))}),n.on("click",".notice-dismiss",function(e){e.preventDefault();var a=s(this).parent();a.removeAttr("role"),a.fadeTo(100,0,function(){a.slideUp(100,function(){a.remove(),i.trigger("focus")})})}),i.on("keypress",function(e){13===e.which&&(e.preventDefault(),o.trigger("click"))}),0===p.children("tr").not(d).length&&r.hide()}(jQuery);