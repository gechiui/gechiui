/*! This file is auto-generated */
jQuery(function(c){var a,o=gc.i18n.__,n=gc.i18n._n,r=gc.i18n.sprintf,e=new ClipboardJS(".site-health-copy-buttons .copy-button"),l=c(".health-check-body.health-check-status-tab").length,t=c(".health-check-body.health-check-debug-tab").length,i=c("#health-check-accordion-block-gc-paths-sizes"),h=c("#adminmenu .site-health-counter"),u=c("#adminmenu .site-health-counter .count");function d(e){var t,s,a=gc.template("health-check-issue"),i=c("#health-check-issues-"+e.status);!function(e){var t,s,a,i,n={test:"string",label:"string",description:"string"},c=!0;if("object"==typeof e){for(t in n)if("object"==typeof(s=n[t]))for(a in s)i=s[a],void 0!==e[t]&&void 0!==e[t][a]&&i===typeof e[t][a]||(c=!1);else void 0!==e[t]&&s===typeof e[t]||(c=!1);return c}}(e)||(SiteHealth.site_status.issues[e.status]++,s=SiteHealth.site_status.issues[e.status],void 0===e.test&&(e.test=e.status+s),"critical"===e.status?t=r(n("%s\u4e2a\u5173\u952e\u95ee\u9898","%s\u4e2a\u5173\u952e\u95ee\u9898",s),'<span class="issue-count">'+s+"</span>"):"recommended"===e.status?t=r(n("%s\u4e2a\u63a8\u8350\u7684\u6539\u8fdb","%s\u4e2a\u63a8\u8350\u7684\u6539\u8fdb",s),'<span class="issue-count">'+s+"</span>"):"good"===e.status&&(t=r(n("%s\u4e2a\u6ca1\u6709\u95ee\u9898\u7684\u9879\u76ee","%s\u4e2a\u6ca1\u6709\u95ee\u9898\u7684\u9879\u76ee",s),'<span class="issue-count">'+s+"</span>")),t&&c(".site-health-issue-count-title",i).html(t),u.text(SiteHealth.site_status.issues.critical),0<parseInt(SiteHealth.site_status.issues.critical,0)?(c("#health-check-issues-critical").removeClass("hidden"),h.removeClass("count-0")):h.addClass("count-0"),0<parseInt(SiteHealth.site_status.issues.recommended,0)&&c("#health-check-issues-recommended").removeClass("hidden"),c(".issues","#health-check-issues-"+e.status).append(a(e)))}function p(){var e=c(".site-health-progress"),t=e.closest(".site-health-progress-wrapper"),s=c(".site-health-progress-label",t),a=c(".site-health-progress svg #bar"),i=parseInt(SiteHealth.site_status.issues.good,0)+parseInt(SiteHealth.site_status.issues.recommended,0)+1.5*parseInt(SiteHealth.site_status.issues.critical,0),n=.5*parseInt(SiteHealth.site_status.issues.recommended,0)+1.5*parseInt(SiteHealth.site_status.issues.critical,0),n=100-Math.ceil(n/i*100);0===i?e.addClass("hidden"):(t.removeClass("loading"),i=a.attr("r"),e=Math.PI*(2*i),a.css({strokeDashoffset:(100-(n=100<(n=n<0?0:n)?100:n))/100*e+"px"}),80<=n&&0===parseInt(SiteHealth.site_status.issues.critical,0)?(t.addClass("green").removeClass("orange"),s.text(o("\u826f\u597d")),gc.a11y.speak(o("\u6240\u6709\u7cfb\u7edf\u5065\u5eb7\u6d4b\u8bd5\u90fd\u5df2\u5b8c\u6210\u8fd0\u884c\u3002\u4f60\u7684\u7cfb\u7edf\u770b\u8d77\u6765\u4e0d\u9519\uff0c\u7ed3\u679c\u53ef\u4ee5\u5728\u9875\u9762\u4e0a\u67e5\u770b\u3002"))):(t.addClass("orange").removeClass("green"),s.text(o("\u6709\u5f85\u6539\u8fdb")),gc.a11y.speak(o("\u6240\u6709\u7cfb\u7edf\u5065\u5eb7\u6d4b\u8bd5\u90fd\u5df2\u5b8c\u6210\u8fd0\u884c\u3002\u6709\u4e9b\u9879\u76ee\u9700\u8981\u89e3\u51b3\uff0c\u7ed3\u679c\u73b0\u5728\u53ef\u4ee5\u5728\u9875\u9762\u4e0a\u67e5\u770b\u3002"))),l&&(c.post(ajaxurl,{action:"health-check-site-status-result",_gcnonce:SiteHealth.nonce.site_status_result,counts:SiteHealth.site_status.issues}),100===n)&&(c(".site-status-all-clear").removeClass("hide"),c(".site-status-has-issues").addClass("hide")))}function g(e,t){e={status:"recommended",label:o("\u6d4b\u8bd5\u4e0d\u53ef\u7528"),badge:{color:"red",label:o("\u4e0d\u53ef\u7528")},description:"<p>"+e+"</p><p>"+t+"</p>",actions:""};d(gc.hooks.applyFilters("site_status_test_result",e))}function s(){var t=(new Date).getTime(),s=window.setTimeout(function(){gc.a11y.speak(o("\u8bf7\u7a0d\u7b49..."))},3e3);gc.apiRequest({path:"/gc-site-health/v1/directory-sizes"}).done(function(e){var a,s;a=e||{},e=c("button.button.copy-button"),s=e.attr("data-clipboard-text"),c.each(a,function(e,t){t=t.debug||t.size;void 0!==t&&(s=s.replace(e+": loading...",e+": "+t))}),e.attr("data-clipboard-text",s),i.find("td[class]").each(function(e,t){var t=c(t),s=t.attr("class");a.hasOwnProperty(s)&&a[s].size&&t.text(a[s].size)})}).always(function(){var e=(new Date).getTime()-t;c(".health-check-gc-paths-sizes.spinner").css("visibility","hidden"),p(),3e3<e?(e=6e3<e?0:6500-e,window.setTimeout(function(){gc.a11y.speak(o("\u6240\u6709\u7cfb\u7edf\u5065\u5eb7\u6d4b\u8bd5\u90fd\u5df2\u5b8c\u6210\u8fd0\u884c\u3002"))},e)):window.clearTimeout(s),c(document).trigger("site-health-info-dirsizes-done")})}e.on("success",function(e){var t=c(e.trigger),s=c(".success",t.closest("div"));e.clearSelection(),t.trigger("focus"),clearTimeout(a),s.removeClass("hidden"),a=setTimeout(function(){s.addClass("hidden")},3e3),gc.a11y.speak(o("\u4fe1\u606f\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f\u3002"))}),c(".health-check-accordion").on("click",".health-check-accordion-trigger",function(){"true"===c(this).attr("aria-expanded")?(c(this).attr("aria-expanded","false"),c("#"+c(this).attr("aria-controls")).attr("hidden",!0)):(c(this).attr("aria-expanded","true"),c("#"+c(this).attr("aria-controls")).attr("hidden",!1))}),c(".site-health-view-passed").on("click",function(){var e=c("#health-check-issues-good");e.toggleClass("hidden"),c(this).attr("aria-expanded",!e.hasClass("hidden"))}),"undefined"!=typeof SiteHealth&&(0===SiteHealth.site_status.direct.length&&0===SiteHealth.site_status.async.length?p():SiteHealth.site_status.issues={good:0,recommended:0,critical:0},0<SiteHealth.site_status.direct.length&&c.each(SiteHealth.site_status.direct,function(){d(this)}),(0<SiteHealth.site_status.async.length?function t(){var s=!0;1<=SiteHealth.site_status.async.length&&c.each(SiteHealth.site_status.async,function(){var e={action:"health-check-"+this.test.replace("_","-"),_gcnonce:SiteHealth.nonce.site_status};return!!this.completed||(s=!1,this.completed=!0,(void 0!==this.has_rest&&this.has_rest?gc.apiRequest({url:gc.url.addQueryArgs(this.test,{_locale:"user"}),headers:this.headers}).done(function(e){d(gc.hooks.applyFilters("site_status_test_result",e))}).fail(function(e){e=void 0!==e.responseJSON&&void 0!==e.responseJSON.message?e.responseJSON.message:o("\u6ca1\u6709\u53ef\u7528\u7684\u8be6\u7ec6\u4fe1\u606f"),g(this.url,e)}):c.post(ajaxurl,e).done(function(e){d(gc.hooks.applyFilters("site_status_test_result",e.data))}).fail(function(e){e=void 0!==e.responseJSON&&void 0!==e.responseJSON.message?e.responseJSON.message:o("\u6ca1\u6709\u53ef\u7528\u7684\u8be6\u7ec6\u4fe1\u606f"),g(this.url,e)})).always(function(){t()}),!1)}),s&&p()}:p)()),t&&(i.length?s:p)(),c(".health-check-offscreen-nav-wrapper").on("click",function(){c(this).toggleClass("visible")})});