/*! This file is auto-generated */
!function(n){var a=n("#appkeys-section"),s=a.find(".create-appkey"),i=s.find(".input"),o=s.find(".button"),r=a.find(".appkeys-list-table-wrapper"),p=a.find("tbody"),d=p.find(".no-items"),e=n("#revoke-all-appkeys"),c=gc.template("new-appkey"),l=gc.template("appkey-row"),u=n("#user_id").val();function f(e,t,a){g(a=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:a,"error")}function g(e,t){t=n("<div></div>").attr("role","alert").attr("tabindex","-1").addClass("is-dismissible notice notice-"+t).append(n("<p></p>").text(e)).append(n("<button></button>").attr("type","button").addClass("notice-dismiss").append(n("<span></span>").addClass("screen-reader-text").text(gc.i18n.__("\u5ffd\u7565\u6b64\u901a\u77e5\u3002"))));return s.after(t),t}function v(){n(".notice",a).remove()}o.on("click",function(e){var t;e.preventDefault(),o.prop("aria-disabled")||(0===(e=i.val()).length?i.trigger("focus"):(v(),o.prop("aria-disabled",!0).addClass("disabled"),t={name:e},t=gc.hooks.applyFilters("gc_appkeys_new_password_request",t,u),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys?_locale=user",method:"POST",data:t}).always(function(){o.removeProp("aria-disabled").removeClass("disabled")}).done(function(e){i.val(""),o.prop("disabled",!1),s.after(c({name:e.name,password:e.password})),n(".new-appkey-notice").trigger("focus"),p.prepend(l(e)),r.show(),d.remove(),gc.hooks.doAction("gc_appkeys_created_password",e,t)}).fail(f)))}),p.on("click",".delete",function(e){var t,a;e.preventDefault(),window.confirm(gc.i18n.__("\u60a8\u786e\u5b9a\u8981\u64a4\u9500\u8fd9\u4e2a\u5bc6\u7801\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u6d88\u3002"))&&(t=n(this),e=(a=t.closest("tr")).data("uuid"),v(),t.prop("disabled",!0),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys/"+e+"?_locale=user",method:"DELETE"}).always(function(){t.prop("disabled",!1)}).done(function(e){e.deleted&&(0===a.siblings().length&&r.hide(),a.remove(),g(gc.i18n.__("Appkey\u5df2\u64a4\u6d88\u3002"),"success").trigger("focus"))}).fail(f))}),e.on("click",function(e){var t;e.preventDefault(),window.confirm(gc.i18n.__("\u60a8\u786e\u5b9a\u8981\u64a4\u9500\u6240\u6709\u5bc6\u7801\u5417\uff1f\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u6d88\u3002"))&&(t=n(this),v(),t.prop("disabled",!0),gc.apiRequest({path:"/gc/v2/users/"+u+"/appkeys?_locale=user",method:"DELETE"}).always(function(){t.prop("disabled",!1)}).done(function(e){e.deleted&&(p.children().remove(),a.children(".new-appkey").remove(),r.hide(),g(gc.i18n.__("\u6240\u6709Appkey\u5df2\u64a4\u6d88\u3002"),"success").trigger("focus"))}).fail(f))}),a.on("click",".notice-dismiss",function(e){e.preventDefault();var t=n(this).parent();t.removeAttr("role"),t.fadeTo(100,0,function(){t.slideUp(100,function(){t.remove(),i.trigger("focus")})})}),i.on("keypress",function(e){13===e.which&&(e.preventDefault(),o.trigger("click"))}),0===p.children("tr").not(d).length&&r.hide()}(jQuery);